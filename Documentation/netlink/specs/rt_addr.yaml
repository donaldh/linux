# SPDX-License-Identifier: ((GPL-2.0 WITH Linux-syscall-note) OR BSD-3-Clause)

name: rt-addr
protocol: netlink
protonum: 0

doc:
  Address configuration over rtnetlink.

definitions:
  -
    name: ifaddrmsg
    type: struct
    members:
      -
        name: family
        type: u8
      -
        name: prefixlen
        type: u8
      -
        name: flags
        type: u8
      -
        name: scope
        type: u8
      -
        name: index
        type: u32
  -
    name: ifa-cacheinfo
    type: struct
    members:
      -
        name: ifa-prefered
        type: u32
      -
        name: ifa-valid
        type: u32
      -
        name: cstamp
        type: u32
      -
        name: tstamp
        type: u32

  -
    name: ifa-flags
    type: flags
    entries:
      -
        name: secondary
      -
        name: nodad
      -
        name: optimistic
      -
        name: dadfailed
      -
        name: homeaddress
      -
        name: deprecated
      -
        name: tentative
      -
        name: permanent
      -
        name: managetempaddr
      -
        name: noprefixroute
      -
        name: mcautojoin
      -
        name: stable-privacy

attribute-sets:
  -
    name: addr-attrs
    attributes:
      -
        name: ifa-address
        type: binary
      -
        name: ifa-local
        type: binary
      -
        name: ifa-label
        type: string
      -
        name: ifa-broadcast
        type: binary
      -
        name: ifa-anycast
        type: binary
      -
        name: ifa-cacheinfo
        type: binary
        struct: ifa-cacheinfo
      -
        name: ifa-multicast
        type: binary
      -
        name: ifa-flags
        type: u32
        enum: ifa-flags
        enum-as-flags: true
      -
        name: ifa-rt-priority
        type: u32
      -
        name: ifa-target-netnsid
        type: binary
      -
        name: ifa-proto
        type: u8


operations:
  list:
    -
      name: addr-get
      doc: Get / dump address information.
      value: 22
      attribute-set: addr-attrs
      fixed-header: ifaddrmsg
      do:
        reply: &addr-all
          attributes:
            - index

mcast-groups:
  list:
    -
      name: mgmt
