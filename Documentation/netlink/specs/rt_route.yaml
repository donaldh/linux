# SPDX-License-Identifier: ((GPL-2.0 WITH Linux-syscall-note) OR BSD-3-Clause)

name: rt-route
protocol: netlink-raw
protonum: 0

doc:
  Route configuration over rtnetlink.

definitions:
  -
    name: rtm-type
    name-prefix: rtn-
    type: enum
    entries:
      - unspec
      - unicast
      - local
      - broadcast
      - anycast
      - multicast
      - blackhole
      - unreachable
      - prohibit
      - throw
      - nat
      - xresolve
  -
    name: rtmsg
    type: struct
    members:
      -
        name: rtm-family
        type: u8
      -
        name: rtm-dst-len
        type: u8
      -
        name: rtm-src-len
        type: u8
      -
        name: rtm-tos
        type: u8
      -
        name: rtm-table
        type: u8
      -
        name: rtm-protocol
        type: u8
      -
        name: rtm-scope
        type: u8
      -
        name: rtm-type
        type: u8
        enum: rtm-type
      -
        name: rtm-flags
        type: u32
  -
    name: rta-cacheinfo
    type: struct
    members:
      -
        name: rta-clntref
        type: u32
      -
        name: rta-lastuse
        type: u32
      -
        name: rta-expires
        type: u32
      -
        name: rta-error
        type: u32
      -
        name: rta-used
        type: u32

attribute-sets:
  -
    name: route-attrs
    attributes:
      -
        name: rta-dst
        type: binary
        display-hint: ipv4
      -
        name: rta-src
        type: binary
        display-hint: ipv4
      -
        name: rta-iif
        type: u32
      -
        name: rta-oif
        type: u32
      -
        name: rta-gateway
        type: binary
        display-hint: ipv4
      -
        name: rta-priority
        type: binary
      -
        name: rta-prefsrc
        type: binary
        display-hint: ipv4
      -
        name: rta-metrics
        type: binary
      -
        name: rta-multipath
        type: binary
      -
        name: rta-protoinfo
        type: binary
      -
        name: rta-flow
        type: u32
      -
        name: rta-cacheinfo
        type: binary
        struct: rta-cacheinfo
      -
        name: rta-session
        type: binary
      -
        name: rta-mp-algo
        type: binary
      -
        name: rta-table
        type: u32
      -
        name: rta-mark
        type: binary
      -
        name: rta-mfc-stats
        type: binary
      -
        name: rta-via
        type: binary
      -
        name: rta-newdst
        type: binary
      -
        name: rta-pref
        type: binary
      -
        name: rta-encap-type
        type: binary
      -
        name: rta-encap
        type: binary
      -
        name: rta-expires
        type: binary
      -
        name: rta-pad
        type: binary
      -
        name: rta-uid
        type: binary
      -
        name: rta-ttl-propagate
        type: binary
      -
        name: rta-ip-proto
        type: binary
      -
        name: rta-sport
        type: binary
      -
        name: rta-dport
        type: binary
      -
        name: rta-nh-id
        type: binary

operations:
  enum-model: directional
  list:
    -
      name: getroute
      doc: Dump route information.
      attribute-set: route-attrs
      fixed-header: rtmsg
      dump:
        request:
          value: 26
        reply:
          value: 24
